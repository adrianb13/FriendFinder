<!DOCTYPE html>
<html lang="en_us">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Friend Finder</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">

    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script src="../data/friends.js"></script>

</head>

<body>
    <div class="container">
        <h1><u>Survey Questions</u></h1>
        <hr>

        <h3><strong>About You</strong></h3>
        <h4>Name (Required)</h4>
        <input type="text" id="name" class="form-control" required>
        <br>

        <h4>Link To Photo Image (Required)</h4>
        <input type="text" id="photo" class="form-control" required>
        
        <hr>

        <h3><strong>Question1</strong></h3>
        <h4>You like being outdoors in nature.</h4>
        <select id="q1">
            <option value=""></option>
            <option value=1>1 (Strongly Disagree)</option>
            <option value=2>2</option>
            <option value=3>3</option>
            <option value=4>4</option>
            <option value=5>5 (Strongly Agree)</option>
        </select>
        <br>

        <h3><strong>Question2</strong></h3>
        <h4>You like trying out new things.</h4>
        <select id="q2">
            <option value=""></option>
            <option value=1>1 (Strongly Disagree)</option>
            <option value=2>2</option>
            <option value=3>3</option>
            <option value=4>4</option>
            <option value=5>5 (Strongly Agree)</option>
        </select>
        <br>

        <h3><strong>Question3</strong></h3>
        <h4>You are a "foodie" and love to eat different types of food.</h4>
        <select id="q3">
            <option value=""></option>
            <option value=1>1 (Strongly Disagree)</option>
            <option value=2>2</option>
            <option value=3>3</option>
            <option value=4>4</option>
            <option value=5>5 (Strongly Agree)</option>
        </select>
        <br>

        <h3><strong>Question4</strong></h3>
        <h4>You are spontaneous and will do things "out of the blue".</h4>
        <select id="q4">
            <option value=""></option>
            <option value=1>1 (Strongly Disagree)</option>
            <option value=2>2</option>
            <option value=3>3</option>
            <option value=4>4</option>
            <option value=5>5 (Strongly Agree)</option>
        </select>
        <br>

        <h3><strong>Question5</strong></h3>
        <h4>You like travel and explore new places and cultures.</h4>
        <select id="q5">
            <option value=""></option>
            <option value=1>1 (Strongly Disagree)</option>
            <option value=2>2</option>
            <option value=3>3</option>
            <option value=4>4</option>
            <option value=5>5 (Strongly Agree)</option>
        </select>
        <br>

        <h3><strong>Question6</strong></h3>
        <h4>You enjoy the comforts home and staying inside.</h4>
        <select id="q6">
            <option value=""></option>
            <option value=1>1 (Strongly Disagree)</option>
            <option value=2>2</option>
            <option value=3>3</option>
            <option value=4>4</option>
            <option value=5>5 (Strongly Agree)</option>
        </select>
        <br>

        <h3><strong>Question7</strong></h3>
        <h4>You enjoy entertainment through technology. For example: "gaming," or binge watching through Netflix.</h4>
        <select id="q7">
            <option value=""></option>
            <option value=1>1 (Strongly Disagree)</option>
            <option value=2>2</option>
            <option value=3>3</option>
            <option value=4>4</option>
            <option value=5>5 (Strongly Agree)</option>
        </select>
        <br>

        <h3><strong>Question8</strong></h3>
        <h4>You enjoy being out with a group of friends to share the experience/moment.</h4>
        <select id="q8">
            <option value=""></option>
            <option value=1>1 (Strongly Disagree)</option>
            <option value=2>2</option>
            <option value=3>3</option>
            <option value=4>4</option>
            <option value=5>5 (Strongly Agree)</option>
        </select>
        <br>

        <h3><strong>Question9</strong></h3>
        <h4>You live a healthy lifestyle through exercise and proper diet.</h4>
        <select id="q9">
            <option value=""></option>
            <option value=1>1 (Strongly Disagree)</option>
            <option value=2>2</option>
            <option value=3>3</option>
            <option value=4>4</option>
            <option value=5>5 (Strongly Agree)</option>
        </select>
        <br>

        <h3><strong>Question10</strong></h3>
        <h4>You have a busy work schedule and work long hours.</h4>
        <select id="q10">
            <option value=""></option>
            <option value=1>1 (Strongly Disagree)</option>
            <option value=2>2</option>
            <option value=3>3</option>
            <option value=4>4</option>
            <option value=5>5 (Strongly Agree)</option>
        </select>
        <br>
        <br>

        <button type="submit" class="btn btn-primary btn-lg" id="submit" data-toggle="modal" data-target="#myModal">
            <i class="fa fa-check-circle" aria-hidden="true"></i> Submit
        </button>
        <hr>

    </div>

    <footer class="footer">
        <div class="container">
            <p>
                <a href="/api/friends">API Friends</a> | <a href="https://github.com/adrianb13/FriendFinder">Github Repository</a>
            </p>
        </div>
    </footer>

    <div id="resultsModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h2 class="modal-title"><strong>Best Match</strong></h2>
                </div>

                <div class="modal-body">
                    <h2 id="matchName"></h2>
                    <img id="matchPhoto" src="" alt="" height=auto width=400px>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

</body>
<script>

var sumList = [];
scores();

var index = 0;
var num1 = sumList[0];

$(document).on("click", "#submit", function(){
    event.preventDefault();
    validate();

    if (validate() === true) {
        var name = $("#name").val().trim();
        var photo = $("#photo").val().trim();
        var scores = [];
        var userSum = 0;
        for (i = 1; i < 11; i++) {
            var score = parseInt($("#q" + i).val());
            scores.push(score);
            
            userSum += parseInt($("#q"+ i).val());
        }

        var newFriend = {
            name: name,
            photo: photo,
            scores: scores
        }

        currentFriends.push(newFriend);
        console.log(currentFriends);
        console.log(sumList);
        compare(userSum, sumList)
        modalDisplay(currentFriends, index);

        $.post("/api/friends", newFriend, function(data) {
            console.log("-------")
            console.log(data);
            console.log("-------")
            $("#name").val("");
            $("#photo").val("");
            for (j = 1; j < 11; j++) {
                $("#q" + j).val("");
            }   
            
        });
    } else {
        alert("You Are Missing Answers. Please Fill Out Form Completely.")
    }
});

function validate() {
    var isValid = true;
    $(".form-control").each(function() {
        if ($(this).val() === "") {
            isValid = false;
        }
    });

    $(".chosen-select").each(function() {
        if ($(this).val() === "") {
            isValid = false;
        }
    });
    return isValid;
};

function compare (userSum, sumList) {
    console.log(userSum)
    for (i = 0; i < sumList.length; i++) {
        console.log("num1 =" +num1)
        userSum = parseInt(userSum);
        if (Math.abs(userSum-sumList[i]) < Math.abs(userSum-num1)) {
            num1 = sumList[i];
            index = i
        }
    }
    console.log("Your match:" + num1 + "-" + index);
}

function modalDisplay(currentFriends, index) {
    $("#matchName").text(currentFriends[index].name);
    $("#matchPhoto").attr("src", currentFriends[index].photo);
    $("#resultsModal").modal("toggle");
    console.log(currentFriends[index].name);
}

</script>

</html>